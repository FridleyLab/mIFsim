<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function generates a simulated tissue using a specified number of
clusters and spatial parameters for each pattern in the simulation object.
The tissue is represented by a grid of points with probabilities of
belonging to stromal or tumor tissue, based on a Gaussian kernel density
estimate calculated for each pattern"><title>Generate Tissue — GenerateTissue • csPointPros</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Tissue — GenerateTissue"><meta property="og:description" content="This function generates a simulated tissue using a specified number of
clusters and spatial parameters for each pattern in the simulation object.
The tissue is represented by a grid of points with probabilities of
belonging to stromal or tumor tissue, based on a Gaussian kernel density
estimate calculated for each pattern"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">csPointPros</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01_Introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/a02_Using_with%20spatialTIME.html">Using with spatialTIME</a>
    <a class="dropdown-item" href="../articles/a03_CellAttributes.html">Adding Cell Attributes</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/FridleyLab/mIFsim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generate Tissue</h1>
      <small class="dont-index">Source: <a href="https://github.com/FridleyLab/mIFsim/blob/HEAD/R/create_tissue.R" class="external-link"><code>R/create_tissue.R</code></a></small>
      <div class="d-none name"><code>GenerateTissue.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a simulated tissue using a specified number of
clusters and spatial parameters for each pattern in the simulation object.
The tissue is represented by a grid of points with probabilities of
belonging to stromal or tumor tissue, based on a Gaussian kernel density
estimate calculated for each pattern</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GenerateTissue</span><span class="op">(</span></span>
<span>  <span class="va">sim_object</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xmin <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  xmax <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ymin <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ymax <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  sdmin <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  sdmax <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  density_heatmap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  step_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>sim_object</dt>
<dd><p>A <code>SpatSimObj</code> created with
<code><a href="CreateSimulationObject.html">CreateSimulationObject</a></code>.</p></dd>


<dt>k</dt>
<dd><p>Number of clusters to generate for each pattern</p></dd>


<dt>xmin</dt>
<dd><p>Minimum x-coordinate for cluster centers.</p></dd>


<dt>xmax</dt>
<dd><p>Maximum x-coordinate for cluster centers.</p></dd>


<dt>ymin</dt>
<dd><p>Minimum y-coordinate for cluster centers.</p></dd>


<dt>ymax</dt>
<dd><p>Maximum y-coordinate for cluster centers.</p></dd>


<dt>sdmin</dt>
<dd><p>Minimum standard deviation for cluster kernels.</p></dd>


<dt>sdmax</dt>
<dd><p>Maximum standard deviation for cluster kernels.</p></dd>


<dt>force</dt>
<dd><p>Logical, whether to force generation of tissue even if the
generated cluster centers would fall outside the simulation window. If
<code>FALSE</code>, an error will be thrown if cluster centers are outside the
window.</p></dd>


<dt>density_heatmap</dt>
<dd><p>Logical, whether to calculate a density heatmap for
the simulated tissue. If <code>TRUE</code>, a grid of points will be generated
covering the entire simulation window, and the probability of each grid
point belonging to stroma will be calculated based on the generated tissue
probability.</p></dd>


<dt>step_size</dt>
<dd><p>Grid step size for the density heatmap.</p></dd>


<dt>cores</dt>
<dd><p>Number of cores to use for parallel processing of density
calculations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A modified 'Spatial Simulation Object' with updated tissue grids and
assigned tissue types for each simulated pattern.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function generates a simulated tissue for each pattern in the
simulation object by first generating k clusters within the specified x
and y ranges and with a standard deviation within the specified range.
Then, a Gaussian kernel density estimate is calculated for each pattern
using the generated clusters as center points and the specified standard
deviation as kernel size. The density estimates represent the probability
of each point in the simulation window belonging to a tumor or stromal
tissue. If <code>density_heatmap = TRUE</code>, a density heatmap will be
calculated using a grid of points covering the entire simulation window.
Finally, for each simulated point, the probability of belonging to stroma
tissue is calculated based on the kernel density estimate, and the tissue
type is assigned as either "Tumor" or "Stroma" using a random sample with
probability proportional to the probability of belonging to stroma tissue.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Create a simulation object with a window and point pattern</span></span></span>
<span class="r-in"><span><span class="va">sim_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="CreateSimulationObject.html">CreateSimulationObject</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No `window` specified - defaulting to x (0, 10); y (0, 10)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#simulate points</span></span></span>
<span class="r-in"><span><span class="va">sim_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="GenerateSpatialPattern.html">GenerateSpatialPattern</a></span><span class="op">(</span><span class="va">sim_object</span>, lambda <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate tissue with default parameters</span></span></span>
<span class="r-in"><span><span class="va">sim_object</span> <span class="op">&lt;-</span> <span class="fu">GenerateTissue</span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'sim_object' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alex Soupir, Christopher Wilson, Julia Wrobel, Oscar Ospina, Brooke Fridley, Fridley Lab.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

