<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mIFsim">
<title>Simulating Bivariate Cells • mIFsim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating Bivariate Cells">
<meta property="og:description" content="mIFsim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mIFsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Bivariate_Simulation.html">Simulating Bivariate Cells</a>
    <a class="dropdown-item" href="../articles/Univariate_Simulation.html">Simulating Univariate Cells</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulating Bivariate Cells</h1>
            
      
      
      <div class="d-none name"><code>Bivariate_Simulation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>In some cases, 2 or more cell types are wanted to assess how well
different methods are able to pick up colocalization or segregation.
With <code>mIFsim</code>, we have implemented a way to perform such
simulated cell arrangements.</p>
</div>
<div class="section level2">
<h2 id="libraries">Libraries<a class="anchor" aria-label="anchor" href="#libraries"></a>
</h2>
<p>In order to get started simulating bivariate multiple
immunofluorescence (mIF) samples, we need to import the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mIFsim</span><span class="op">)</span></span>
<span><span class="co">#&gt; mIFsim Version:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB;">0.0.0.9000</span></span></span>
<span><span class="co">#&gt;             _____ ______   _</span></span>
<span><span class="co">#&gt;            |_   _|  ____| (_)</span></span>
<span><span class="co">#&gt;   _ __ ___   | | | |__ ___ _ _ __ ___</span></span>
<span><span class="co">#&gt;  | '_ ` _ \  | | |  __/ __| | '_ ` _ \</span></span>
<span><span class="co">#&gt;  | | | | | |_| |_| |  \__ \ | | | | | |</span></span>
<span><span class="co">#&gt;  |_| |_| |_|_____|_|  |___/_|_| |_| |_|</span></span>
<span><span class="co">#&gt;  Fridley Lab <span style="color: #BBBBBB;">Enjoy</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-mifsim">Running mIFsim<a class="anchor" aria-label="anchor" href="#running-mifsim"></a>
</h2>
<p>To create a simulation object, we can call
<code>create_simObject</code>, which takes in 3 arguments that will
initialize the object for all downstream functions:</p>
<ol style="list-style-type: decimal">
<li>
<code>window</code> - a <code>spatstat</code> window object which is
the boundary for which to simulate our points</li>
<li>
<code>sims</code> - an integer value that is the number of samples
that is wanting to be simulated</li>
<li>
<code>cell_types</code> - this is the number of different phenotypes
to simulate, here we will do 2 for CD3+ and CD19+</li>
</ol>
<p>If a window isn’t specified a built in 10x10 will be used. Let’s
create our simulation object. The number of simulations is also
defaulted to 3 but for assessing these colocalization methods, probably
want to use a lot to get confidence but here we will use 9.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_object</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_simObject.html">create_simObject</a></span><span class="op">(</span>sims <span class="op">=</span> <span class="fl">9</span>, cell_types <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: spatstat</span></span>
<span><span class="co">#&gt; Loading required package: spatstat.data</span></span>
<span><span class="co">#&gt; Loading required package: spatstat.geom</span></span>
<span><span class="co">#&gt; spatstat.geom 3.2-1</span></span>
<span><span class="co">#&gt; Loading required package: spatstat.random</span></span>
<span><span class="co">#&gt; spatstat.random 3.1-5</span></span>
<span><span class="co">#&gt; Loading required package: spatstat.explore</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; spatstat.explore 3.2-1</span></span>
<span><span class="co">#&gt; Loading required package: spatstat.model</span></span>
<span><span class="co">#&gt; Loading required package: rpart</span></span>
<span><span class="co">#&gt; spatstat.model 3.2-4</span></span>
<span><span class="co">#&gt; Loading required package: spatstat.linnet</span></span>
<span><span class="co">#&gt; spatstat.linnet 3.1-1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; spatstat 3.0-6 </span></span>
<span><span class="co">#&gt; For an introduction to spatstat, type 'beginner'</span></span>
<span><span class="co">#&gt; No `window` specified - defaulting to x (0, 10); y (0, 10)</span></span></code></pre></div>
<p>Using the <code>summary</code> method, we can see what our simulation
object has inside and what we need to do next. Here, we have 9
simulations with the default window and are wanting to perform this for
2 cell types. This method is really useful for when fine tuning
parameters to get the desired output because it shows you exactly what
has already been done when loading in the base object from an RDS
file.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spatial Simulation object for 9 simulations. Currently, there are:</span></span>
<span><span class="co">#&gt;  Window: x (0,10); y (0,10)</span></span>
<span><span class="co">#&gt;  0 spatial processes</span></span>
<span><span class="co">#&gt;  0 tissue kernels</span></span>
<span><span class="co">#&gt;  0 hole kernels</span></span>
<span><span class="co">#&gt;  0 cell kernels for 2 cell types</span></span></code></pre></div>
<p>Now that we have our simulation object and parameters set within, we
need to create the point pattern process. The
<code>GenerateSpatialProcess</code> function takes in the spatial
simulation object and a <code>lambda</code>, or intensity of the point
process. <strong>NOTE: with large windows and large lambdas, the size of
the spatial simulation object can grow fast so be mindful.</strong> Any
other parameters that could be passed to
<code><a href="https://rdrr.io/pkg/spatstat.random/man/rpoispp.html" class="external-link">spatstat.random::rpoispp</a></code> can then be passed to
<code>GenerateSpatialProcess</code> at the end. Again, we can check how
we are filling in our slots with <code>summary</code> and even see how
our new process looks like with <code>plot</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_object</span> <span class="op">=</span> <span class="fu"><a href="../reference/GenerateSpatialProcess.html">GenerateSpatialProcess</a></span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spatial Simulation object for 9 simulations. Currently, there are:</span></span>
<span><span class="co">#&gt;  Window: x (0,10); y (0,10)</span></span>
<span><span class="co">#&gt;  9 spatial processes</span></span>
<span><span class="co">#&gt;  0 tissue kernels</span></span>
<span><span class="co">#&gt;  0 hole kernels</span></span>
<span><span class="co">#&gt;  0 cell kernels for 2 cell types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span></code></pre></div>
<p><img src="Bivariate_Simulation_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Next we will generate some regions of the tumor an stroma. There are
some parameters that are initialized when building the spatial
simulation that tells downstream functions how to simulate things on a
Gaussian kernel - <code>GenerateTissue</code> is one of those. If there
is nothing supplied to the function when calling, it will default to
these values. Alternatively, can specify them in the function call.
These include regions within your window that you would like tissue
regions to be simulated, the number of regions, the standard deviation
range for how the probability falls off around the region centers, etc.
Something here is whether the ending kernel should be converted to a
heatmap and at what resolution. <strong>NOTE: the smaller the
<code>step_size</code> used for the heatmap the longer it takes to run
so be mindful.</strong> If metrics are changed, then they can be
recalled later to know exactly what was used to generate the data.</p>
<p>After simulating the tissues we can look at the summary of the
spatial simulation object to see the newly filled slot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_object</span> <span class="op">=</span> <span class="fu"><a href="../reference/GenerateTissue.html">GenerateTissue</a></span><span class="op">(</span><span class="va">sim_object</span>, density_heatmap <span class="op">=</span> <span class="cn">T</span>, step_size <span class="op">=</span> <span class="fl">0.1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing density heatmap</span></span>
<span><span class="co">#&gt; Computing tissue probability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spatial Simulation object for 9 simulations. Currently, there are:</span></span>
<span><span class="co">#&gt;  Window: x (0,10); y (0,10)</span></span>
<span><span class="co">#&gt;  9 spatial processes</span></span>
<span><span class="co">#&gt;  9 tissue kernels</span></span>
<span><span class="co">#&gt;  0 hole kernels</span></span>
<span><span class="co">#&gt;  0 cell kernels for 2 cell types</span></span></code></pre></div>
<p>The tissue kernel slot is now filled the number of kernels matching
number of spatial processes we have. Let’s take a look at the simulated
tissue kernels with <code>PlotSimulation</code> and <code>what</code> as
the tissue heatmap.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotSimulation.html">PlotSimulation</a></span><span class="op">(</span><span class="va">sim_object</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span>, what <span class="op">=</span> <span class="st">"tissue heatmap"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span></code></pre></div>
<p><img src="Bivariate_Simulation_files/figure-html/unnamed-chunk-6-1.png" width="864"></p>
<p>The kernels are randomly laid about the simulation region and random
sizes within the constraints of the parameters used. The number of
tissue regions simulated are fixed by the input <code>k</code> value,
and not sampled from a distribution centered at <code>k</code>. A larger
<code>sdmin</code> and <code>sdmax</code> would increase the sizes of
the tissue regions.</p>
<p>Generating holes can help assess the need for correcting spatial
statistic metrics derived. For example, if there is a pond in the center
of a field (a hole), crops are not able to be planted there yet
measuring the amount of field there is just by the outside border
(window) will say that lots of crops should be able to fit. Sometimes,
these things need to be adjusted for. Even if not using holes for
assessing metrics, performing them will just create a new column in the
spatial files that can be later ignored.</p>
<p>The parameters that go into <code>GenerateHoles</code> is similar to
that of <code>GenerateTissue</code> with one addition:
<code>hole_prob</code> or the proportion range of the point processes
that could become holes. All of these parameters had defaults set when
the spatial simulation object was created, but can be overridden here if
a particular area of the process is wanted to have the holes and not the
rest (x and y min and max ranges). The number of holes is random as long
as the sum of the area is within the proportions above.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_object</span> <span class="op">=</span> <span class="fu"><a href="../reference/GenerateHoles.html">GenerateHoles</a></span><span class="op">(</span><span class="va">sim_object</span>, density_heatmap <span class="op">=</span> <span class="cn">T</span>, step_size <span class="op">=</span> <span class="fl">0.1</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing density heatmap</span></span>
<span><span class="co">#&gt; Computing hole probability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spatial Simulation object for 9 simulations. Currently, there are:</span></span>
<span><span class="co">#&gt;  Window: x (0,10); y (0,10)</span></span>
<span><span class="co">#&gt;  9 spatial processes</span></span>
<span><span class="co">#&gt;  9 tissue kernels</span></span>
<span><span class="co">#&gt;  9 hole kernels</span></span>
<span><span class="co">#&gt;  0 cell kernels for 2 cell types</span></span></code></pre></div>
<p>Let’s see how the kernels for holes look. The center of the holes
have the highest probability of being removed with a Bernoulli
distribution of ‘hole’ or ‘not a hole’. The <code>what</code> parameter
is now “hole heatmap”.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotSimulation.html">PlotSimulation</a></span><span class="op">(</span><span class="va">sim_object</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span>, what <span class="op">=</span> <span class="st">"hole heatmap"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Bivariate_Simulation_files/figure-html/unnamed-chunk-8-1.png" width="864"></p>
<p>Next thing for us to do is to simulate the positivity of cells for a
phenotype. Just like holes and the tissue, there are boundaries which
the simulated positive cells will fall in which are stored in the
parameters. This is helpful for going back and seeing what was done.
However here, there are 2 different parameters that help set the
abundance (<code>probs</code>) and, in the case of multiple cell types,
how related those cell types are (<code>correlation</code>).</p>
<p>The <code>probs</code> parameter is used to scale the probabilities
for the cell type where the first number is away from kernel peaks and
the second is the maximum probability for a cell. For higher abundance,
the maximum probability can be set higher and even increase the minimum
probability. An issue with doing this on point processes that have
multiple cell types is that they are not entirely informed of one
another when assigning cell types. B cells and T cells are distinct
phenotypes and therefore one cell <em>shouldn’t</em> be positive for
both. What we do, is use the probability with the Bernoulli distribution
so there’s a chance a single cell will be positive for 2 cell types,
even if the max probability is 0.1.</p>
<p>Sometimes we want to study the clustering or dispersion of different
cell types. In this case, we want to make them either very alike
(positive correlation) or very different (negative correlation). What we
do in the background is take same probability as the first cell
simulated and adjust it according to the <code>correlation</code>
parameter. The kernels in the spatial simulation object will be the same
for all cell types, but at the time of creating the density heatmap or
assigning a cell positive/negative, the probabilities are adjusted.</p>
<p>Play around with positive or negative correlations and see what
happens.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_object</span> <span class="op">=</span> <span class="fu"><a href="../reference/GenerateCellPositivity.html">GenerateCellPositivity</a></span><span class="op">(</span><span class="va">sim_object</span>, k <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    sdmin <span class="op">=</span> <span class="fl">3</span>, sdmax <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                    density_heatmap <span class="op">=</span> <span class="cn">T</span>, step_size <span class="op">=</span> <span class="fl">0.1</span>, cores <span class="op">=</span> <span class="fl">1</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                                    correlation <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing density heatmap for Cell 1</span></span>
<span><span class="co">#&gt; Computing probability for Cell 1</span></span>
<span><span class="co">#&gt; Adjusting density heatmap for Cell 2</span></span>
<span><span class="co">#&gt; Computing probability for Cell 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spatial Simulation object for 9 simulations. Currently, there are:</span></span>
<span><span class="co">#&gt;  Window: x (0,10); y (0,10)</span></span>
<span><span class="co">#&gt;  9 spatial processes</span></span>
<span><span class="co">#&gt;  9 tissue kernels</span></span>
<span><span class="co">#&gt;  9 hole kernels</span></span>
<span><span class="co">#&gt;  9 cell kernels for 2 cell types</span></span></code></pre></div>
<p>When there are multiple cells to be simulated, we can see the heatmap
for cell type 2 be copied and adjusted by the correltation which is much
faster than calculating the density heatmap from the kernel. Lets look
at how the new cells are distributed in the mIF with a correlation of
-1. This means that the cell types are segregated so Cell 1 is closer to
Cell 1 and Cell 2 is closer to Cell 2. Again, because each cell has a
probability of being positive there will always be some ‘noise’ but the
trend is there.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotSimulation.html">PlotSimulation</a></span><span class="op">(</span><span class="va">sim_object</span>, which <span class="op">=</span> <span class="fl">1</span>, what <span class="op">=</span> <span class="st">"whole core"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Bivariate_Simulation_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<p>Lastly, the data is likely wanted in tabular format. Since there are
multiple simulated point processes, the function
<code>CreateSpatialList</code> returns a list of data frames containing
cell x and y locations, the tissue that the cell belongs to, whether the
cell falls in a hole, and the positivity of the different cell
types.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spatial_list</span> <span class="op">=</span> <span class="fu"><a href="../reference/CreateSpatialList.html">CreateSpatialList</a></span><span class="op">(</span>sim_object <span class="op">=</span> <span class="va">sim_object</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:nlme':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<p>The spatial list can now be used with packages like
<code>spatialTIME</code> to compute spatial statistics on all of the
simulated data frames.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Samantha Bothwell, Alex Soupir, Julia Wrobel, Oscar Ospina, Brooke Fridley, Fridley Lab.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
